

[TOC]



# 一：目录

![](D:/%E4%BD%A0%E5%A5%BDJava/1311.png)



数据库管理系统的结构：

> 1：数据库管理系统内核的组成部分。
>
> 2：数据库管理系统的进程结构

数据库的访问管理

查询优化

事务管理

> 1：并发控制
>
> 2：恢复



# DBMS内核的组成部分：







![](D:/%E4%BD%A0%E5%A5%BDJava/1313.png)

**Parser:语法分析器：**

对用户提交的SQl语句进行语法分析，如果没有语法错误，就会生成一棵语法树，机器就知道用户到底想对谁进行什么操作（增删改查）。如果有语法错误的话，会直接通过接口向用户报错。

**Grant checking：权限检查模块：**

进入权限检查模块之后，就判断一下当前用户有没有权做这个操作。比如：我想进行insert插入操作，想在学生表里面插入一个元组，因为一旦做完语法分析生成语法树以后，机器就知道你要对哪张表进行什么操作。他马上就会检查一下，你到底有没有权利做这个操作。如果你没有权力执行这条SQL的话，会直接通过接口向用户报错。

**语义分析与查询处理模块：**

进行完权限检查之后，就会进入语义分析与查询处理模块。继续上面的例子的话，在这层会调用实现插入操作的函数，去实现插入操作。注意在进行操作的时候，会调用物理层访问管理模块的API，会得到相应的表，视图，元组，属性......。这一层主要是实现了SQL的操作。



**物理层访问管理模块：**

访问管理模块向上层提供的API函数就实现了关系模型里面的各种概念（表，视图，元组，属性......） ,各种这些关系模型的概念落实到操作系统里面具体的文件以及文件字符流映射。即访问管理这层已经实现了关系模型的各种概念，并与底层操作系统中的文件与字符流进行了很好的映射。

注意操作系统中的文件没有数据结构，就是一段平滑的字符流。



# DBMS的进程结构

## 1：多进程结构

![](D:/%E4%BD%A0%E5%A5%BDJava/1314.png)

当你的应用程序调用connect的时候，就向数据库发送一个信息，我要调用数据库了，数据库就会为这个应用程序创建一个DBMS核心进程，当这个核心进程创建好以后，系统就会为这个应用程序和核心之间创建一个通讯的管道，应用程序就将SQL语句经过管道送入核心，核心经过运算之后就将结果送回去。

......

当我们的应用程序很多的话，就会有很多的DBMS核心进程，进程所占的资源是很大的，所以当进程一多，操作系统资源就会不足。系统的性能就会明显的下降。



## 2：多线程的结构

一个数据库系统只有一个DBMS进程，当有应用访问的时候，就在DBMS进程中为其创建一个DBMS核心线程。一个应用程序对应一个DBMS核心线程。

![](D:/%E4%BD%A0%E5%A5%BDJava/1315.png)



**DAEMON线程：**

这个线程主要是起到监听的作用，主要监听数据库系统的端口，当DBMS进程起来的时候，DAEMON这个线程就已经起来了。

主要是看又没有连接请求。

**CARALOG目录：**

 是一种容器，我们存储在数据库中的表，视图，以及他们的存储方式，有没有索引等信息都存储在目录中，比如说我们写一个SQL用来查询student表中的一个属性。首先会在目录中判断一下到底有没有这个表等。如果没有这个表，则直接返回.

sql来的时候先查catelog目录，检查数据库中是否有那个表或者是信息，如果没有则直接返回错误信息。

**locktable封锁表：**



**buffer缓冲区：**



**当你的应用程序调用connect的时候，就向数据库发送一个连接请求，daemon就会捕捉到这个请求，然后在DBMS进程中创建为这个应用程序创建一个DBMS核心线程，并创建一个通讯的管道将这个线程与应用程序连接。连接好之后，daemon就回去继续监听下一条请求。**



# 数据库的访问管理

![image-20240522131202084](D:/%E4%BD%A0%E5%A5%BDJava/image-20240522131202084.png)

访问数据库最终会转换为对操作系统中文件的操作。文件结构及其提供的访问路径将直接影响数据访问的速度。不可能有一种文件结构对所有类型的数据访问都有效。





![image-20240522131217162](D:/%E4%BD%A0%E5%A5%BDJava/image-20240522131217162.png)

1：查询一个文件中的所有原组或者说一个文件中的大多数原组（>15%）   

​			-> 将会查询所有的块（这个文件所占有所有的块）

​		     > **因为从系统中拿数据不是一个字节一个字节拿的，而是一次拿取一个块，一个块大概有1024个字节，**

​                **而当查询的原组数量大于15%的时候，这个关系所设计的数据将会漫步整个文件所占有的块中，所以会查询的时候会涉				及所有的块**







